# AI智能开票服务 - 测试用例

## 测试环境
- URL: http://localhost:3002
- 浏览器: Chrome/Safari/Firefox（最新版）

---

## 测试场景1：完整信息输入 - 腾讯

### 输入
```
请帮我开票：给腾讯开软件服务,金额50000元，数量5个，单价10000元/个
```

### 预期结果
✅ 解析成功
- 客户：深圳市腾讯计算机系统有限公司
- 税号：91440300708461136T
- 商品：软件技术服务
- 金额：¥50,000.00
- 数量：5
- 单价：¥10,000.00
- 税率：6%
- 税额：¥3,000.00
- 价税合计：¥53,000.00

---

## 测试场景2：逻辑错误检测

### 输入（错误）
```
给阿里开云服务，单价100元，数量5个，总共1000元
```

### 预期结果
❌ 显示红色错误气泡
```
逻辑校验不通过：5 × 100 = 500 ≠ 1000，请修正
```

### 修正输入
```
给阿里开云服务，单价100元，数量5个，总共500元
```

### 预期结果
✅ 解析成功
- 客户：阿里巴巴(中国)有限公司
- 税号：913301087254843425
- 商品：云计算服务
- 金额：¥500.00
- 税率：6%
- 税额：¥30.00
- 价税合计：¥530.00

---

## 测试场景3：自动计算（缺少金额）

### 输入
```
给字节开技术服务，数量10个，单价15000元
```

### 预期结果
✅ 自动计算金额
- 客户：北京字节跳动科技有限公司
- 税号：91110108MAOO1KFQ8R
- 商品：信息技术服务
- 数量：10
- 单价：¥15,000.00
- 金额：¥150,000.00（自动计算）
- 税率：6%
- 税额：¥9,000.00
- 价税合计：¥159,000.00

---

## 测试场景4：自动计算（缺少单价）

### 输入
```
给华为开硬件设备，金额26000元，数量2台
```

### 预期结果
✅ 自动计算单价
- 客户：华为技术有限公司
- 税号：914403001922038216
- 商品：电子设备
- 金额：¥26,000.00
- 数量：2
- 单价：¥13,000.00（自动计算）
- 税率：13%（注意是货物销售）
- 税额：¥3,380.00
- 价税合计：¥29,380.00

---

## 测试场景5：自动计算（缺少数量）

### 输入
```
给腾讯开咨询服务，总金额30000元，单价5000元
```

### 预期结果
✅ 自动计算数量
- 客户：深圳市腾讯计算机系统有限公司
- 商品：咨询服务
- 金额：¥30,000.00
- 单价：¥5,000.00
- 数量：6（自动计算）
- 税率：6%
- 税额：¥1,800.00
- 价税合计：¥31,800.00

---

## 测试场景6：不同商品类型 - 6%税率

### 输入A：软件服务
```
给阿里开软件服务，金额10000元，数量1个，单价10000元
```
预期税率：6%

### 输入B：技术服务
```
给字节开技术服务，金额20000元，数量2个，单价10000元
```
预期税率：6%

### 输入C：咨询服务
```
给华为开咨询服务，金额15000元，数量3个，单价5000元
```
预期税率：6%

### 输入D：云服务
```
给腾讯开云服务，金额8000元，数量4个，单价2000元
```
预期税率：6%

---

## 测试场景7：不同商品类型 - 13%税率

### 输入A：电子产品
```
给阿里开电子产品，金额5000元，数量5个，单价1000元
```
预期税率：13%

### 输入B：硬件设备
```
给字节开硬件设备，金额100000元，数量10台，单价10000元
```
预期税率：13%

### 输入C：办公用品
```
给华为开办公用品，金额2000元，数量20个，单价100元
```
预期税率：13%

---

## 测试场景8：简化输入

### 输入（最简化）
```
给腾讯开软件，10000元
```

### 预期结果
✅ 部分解析成功
- 客户：深圳市腾讯计算机系统有限公司（自动补全）
- 商品：软件技术服务（识别"软件"关键词）
- 金额：¥10,000.00
- 税率：6%
- 税额：¥600.00
- 价税合计：¥10,600.00
- 数量/单价：未填写（显示为"-"）

---

## 测试场景9：多种表达方式

### 输入变体1
```
帮我给腾讯开个软件服务的发票，金额50000，5个，每个10000
```

### 输入变体2
```
客户：阿里，商品：云服务，总价500元，数量5个，单价100元
```

### 输入变体3
```
为字节跳动开技术服务发票，共计150000元，共10份，单价15000元一份
```

### 预期结果
✅ 均能成功解析

---

## 边界测试

### 测试10：缺少客户名称
```
开软件服务，金额1000元，数量1个，单价1000元
```
预期：解析成功但客户信息为空或提示"缺少客户名称"

### 测试11：无法识别的客户
```
给小明开软件服务，金额1000元
```
预期：保留"小明"作为客户名称，但不会自动补全企业信息

### 测试12：无法识别的商品类型
```
给腾讯开XXX商品，金额1000元
```
预期：保留"XXX商品"但税率可能为空或使用默认值

### 测试13：超大金额
```
给腾讯开软件服务，金额9999999元，数量1个，单价9999999元
```
预期：正常解析，金额显示正确

### 测试14：小数金额
```
给阿里开云服务，金额1234.56元，数量2个，单价617.28元
```
预期：正常解析，允许0.01误差

---

## 性能测试

### 测试15：快速连续输入
1. 输入测试场景1
2. 等待解析完成
3. 立即输入测试场景2
4. 观察系统响应

预期：每次都能正确解析，不会相互干扰

### 测试16：响应时间
测量从发送到显示结果的时间
预期：2-4秒内完成（模拟处理时间）

---

## UI/UX测试

### 测试17：输入框提示
- 检查输入框placeholder是否清晰可见
- 输入时placeholder是否消失

### 测试18：消息气泡动画
- 用户消息从右侧滑入
- 系统消息从左侧滑入
- 错误消息显示红色边框和图标
- 成功消息显示绿色背景和图标

### 测试19：发票预览更新
- 成功解析后右侧立即显示发票
- 错误时右侧不更新
- 新的成功解析会覆盖旧的发票

### 测试20：滚动行为
- 新消息出现时自动滚动到底部
- 长消息列表可以手动滚动

---

## 兼容性测试

### 浏览器测试
- [ ] Chrome（最新版）
- [ ] Safari（最新版）
- [ ] Firefox（最新版）
- [ ] Edge（最新版）

### 屏幕尺寸测试
- [ ] 桌面端（1920x1080）
- [ ] 笔记本（1440x900）
- [ ] 平板（768px宽）
- [ ] 手机（375px宽）

---

## 回归测试清单

执行时间：每次代码更新后

- [ ] 测试场景1-5（核心功能）
- [ ] 测试场景6-7（税率匹配）
- [ ] 测试场景10-12（边界情况）
- [ ] UI/UX测试（17-20）
- [ ] 浏览器兼容性

---

## 已知问题（如有）

### Issue #1: 文件监听警告
- 现象：控制台显示"EMFILE: too many open files"
- 影响：不影响功能，仅MacOS文件监听限制
- 解决方案：执行 `ulimit -n 10240` 或忽略

---

## 测试完成标准

✅ 所有核心测试场景通过
✅ 无阻塞性bug
✅ 页面响应流畅
✅ 视觉效果符合预期
✅ 至少2个浏览器测试通过

---

**最后更新**: 2025-11-27
**测试人员**: Ray Steve
**测试状态**: 待执行


